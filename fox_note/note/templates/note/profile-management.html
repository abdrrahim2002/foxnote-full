{% load static %}
{% load account %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="{% static "note/css/profile-management.css" %}">

</head>
<body>

  


  <!-- for the title -->
  <header>
    <h1>FOXNOTE</h1>
  </header>


  <!-- for the navbar -->

      <!-- for the navbar -->
      <nav> 
        <div class="navbar-right-section">
  
          <a class="my-notes" href="{% url 'note_account' request.user.username %}" onclick="checkEditing(event)">My notes</a>
    
    
          <button class="my-profile" onclick="toggleDropdown()">
            Profile
          </button>
    
        </div>
  
        <div id="dropdown-menu" class="dropdown-content">
          <a href="{% url 'profile-management' request.user.username %}" style="border-radius: 15px 15px 0 0;" onclick="checkEditing(event)">profile management <img src="{% static 'note/image/profile.png' %}" alt="profile"></a>
          <a href="{% url 'account_logout' %}" style="border-radius: 0 0 15px 15px;" onclick="checkEditing(event)">Logout <img src="{% static 'note/image/logout.png' %}" alt="logout"></a>
        </div>
      </nav>



  <!-- for the message popup -->
  <div class="popup-message-container">
    {% if messages %}
        
      {% for message in messages %}

        <div id="popup-{{ forloop.counter }}" class="popup-message">
          <span class="message">{{ message }}</span>
          <button onclick="closePopup('popup-{{ forloop.counter }}')">&times;</button>
        </div>

      {% endfor %}
      
    {% endif %}


  </div>



  <main>
    <div class="line-1">
      <h3>user name: {{request.user.username}}</h3>

      {% if user.gender %}
        {% if user.gender == 'M' %}
          <img src="{% static "note/image/male.png" %}" alt="Male">
        {% elif user.gender == 'F' %}
          <img src="{% static "note/image/female.png" %}" alt="Female">
        {% endif %}
      {% endif %}

    </div>

    <div class="line-2">
      {% if user_age >= 0 %}
        <p>Age: {{user_age}}</p>
      {% endif %}
    </div>


    <div class="line-3">
      <p id="num-notes" class="num-notes" data-count="{{ notes_number }}">number of notes <span>0</span></p>

      <p id="num-tags" class="num-tags" data-count="{{ tags_number }}">number of tags <span>0</span></p>
    </div>




    {% if user.is_authenticated %}
    <div class="line-4">
      <!--for link a third party profile like google-->
      <!-- check if the user is succesfully linked his account to google or not -->

      {% if social_accounts %}
        {% for account in social_accounts %}
          {% if account.provider == "google" %}
            <div class="tooltip-google-verified">
              <img src="{% static 'note/image/google.png' %}" alt="google icon">
              <div class="tooltiptext">Your account is linked with google</div>
            </div>
          {% endif %}
        {% endfor %}
      {% else %}
        <a class="tooltip-google-not-verified" href="{% url 'socialaccount_connections' %}">
          <img src="{% static 'note/image/google.png' %}" alt="google icon">
          <div class="tooltiptext">Your account is not linked with google</div>
        </a>
        
      {% endif %}

      <!--for manage the email -->
      <!-- i want to make it just for the resend email verification -->
       
      {% with email=user.emailaddress_set.first %}
        {% if email.verified %}
          <div class="tooltip-email-verified">
            <img src="{% static 'note/image/email-verified.png' %}" alt="email verified">
            <div class="tooltiptext">Your email is verified</div>
          </div>
        {% else %}
          <p>Your email is not verified. Please verify your email.</p>
          <form action="{% url 'account_email_verification_sent' %}" method="post">
              {% csrf_token %}
              <button type="submit">Verify your email</button>
          </form>
        {% endif %}
      {% endwith %}

      <!--for resert the password-->
      <a href="{% url 'account_change_password' %}" class="btn btn-primary">reset my password <img src="{% static 'note/image/password-reset.png' %}" alt="email verified successfully"></a>
    </div>

    <div class="line-5">
      <!--for let the user can logout-->
      <a class="logout" href="{% url 'account_logout' %}">Logout <img src="{% static 'note/image/logout.png' %}" alt="logout"></a>

      <!--for deleting profile-->
      <a href="{% url 'delete_profile' %}" class="btn btn-danger">Delete  <img src="{% static 'note/image/trash.png' %}" alt="Delete"></a>
    </div>

    {% endif %}
  </main>
  

  <!-- footer -->
  <footer></footer>


  <!-- todo the animation of removing popup message -->
  <script src="{% static "note/javascript/profile-management.js" %}"></script>

</body>
</html>